<!DOCTYPE HTML>
<html>
<head>
    <meta charset="UTF-8">
    <title>Main</title>
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Stoke">
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Ubuntu">
    <link rel="stylesheet" href="style/bingo.css">
    <link rel="stylesheet" href="style/bingo-desktop.css">
    <link rel="stylesheet" href="style/bingo-dark.css">
    <script src="main.js"></script>
</head>
<body>
<div id="elm-root"></div>
<script type="application/javascript">
    function IEdetection() {
        var ua = window.navigator.userAgent;
        var msie = ua.indexOf('MSIE ');
        if (msie > 0) {
            // IE 10 or older, return version number
            return ('IE ' + parseInt(ua.substring(
                msie + 5, ua.indexOf('.', msie)), 10));
        }
        var trident = ua.indexOf('Trident/');
        if (trident > 0) {
            // IE 11, return version number
            var rv = ua.indexOf('rv:');
            return ('IE ' + parseInt(ua.substring(
                rv + 3, ua.indexOf('.', rv)), 10));
        }
        var edge = ua.indexOf('Edge/');
        if (edge > 0) {
            //Edge (IE 12+), return version number
            return ('IE ' + parseInt(ua.substring(
                edge + 5, ua.indexOf('.', edge)), 10));
        }
        // User uses other browser
        return ('Not IE');
    }

    if (IEdetection() === 'Not IE') {

        const storedState = localStorage.getItem('state-app-save');
        console.log("Retrieved state: ", storedState);
        const startingState = storedState ? JSON.parse(storedState) : {};
        const dark = window.matchMedia && window.matchMedia("(prefers-color-scheme:dark)").matches

        var flags = {
            dark,
            state: startingState
        };

        const app = Elm.Main.init({
            flags: flags,
            node: document.getElementById("elm-root")
        });
        app.ports.storeState.subscribe(function(state) {
            if (state) {
                localStorage.setItem('state-app-save', state);
                console.log("Saved state: ", state);
            }
        });
    } else {
        document.body.innerHTML = "<div style='text-align: center;'><h1>For the best experience please open using Chrome, Firefox, Safari or any modern browser really.</h1>\n" +
            "    <h2>üôè Please stop using IE üôè</h2></div>";
    }

</script>
</body>
</html>
